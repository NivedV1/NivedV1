<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Progressive Masonry Collage + Lightbox</title>
<style>
  body { margin: 0; background: #000; font-family: sans-serif; }
  
  .collage {
    column-count: 5;
    column-gap: 10px;
    padding: 10px;
  }

  .collage img {
    width: 100%;
    margin-bottom: 10px;
    border-radius: 10px;
    opacity: 0;
    transform: scale(0.98);
    transition: opacity 0.6s ease-out, transform 0.6s ease-out;
    cursor: pointer;
    display: block;
  }

  .collage img.loaded {
    opacity: 1;
    transform: scale(1);
  }

  @media (max-width: 1400px) { .collage { column-count: 4; } }
  @media (max-width: 1000px) { .collage { column-count: 3; } }
  @media (max-width: 700px) { .collage { column-count: 2; } }
  @media (max-width: 500px) { .collage { column-count: 1; } }

  /* Lightbox */
  .lightbox {
    position: fixed;
    top: 0; left: 0;
    width: 100vw; height: 100vh;
    background: rgba(0,0,0,0.9);
    display: flex; align-items: center; justify-content: center;
    opacity: 0; pointer-events: none;
    transition: opacity 0.4s ease;
    z-index: 999;
  }
  .lightbox.active { opacity: 1; pointer-events: all; }

  .lightbox img {
    max-width: 90%;
    max-height: 85%;
    border-radius: 10px;
    box-shadow: 0 0 30px rgba(255,255,255,0.3);
  }

  .lightbox button {
    position: absolute;
    background: none; border: none; color: white;
    font-size: 2.5em; cursor: pointer;
    transition: color 0.2s; z-index: 1000;
  }
  .lightbox button:hover { color: #aaa; }
  #closeBtn { top: 20px; right: 30px; font-size: 2em; }
  #prevBtn { left: 40px; }
  #nextBtn { right: 40px; }
</style>
</head>
<body>

<div class="collage" id="collage"></div>

<div class="lightbox" id="lightbox">
  <button id="closeBtn">×</button>
  <button id="prevBtn">❮</button>
  <img id="lightboxImage" src="" alt="Large view">
  <button id="nextBtn">❯</button>
</div>

<script>
const collage = document.getElementById("collage");
const lightbox = document.getElementById("lightbox");
const lightboxImage = document.getElementById("lightboxImage");
const closeBtn = document.getElementById("closeBtn");
const nextBtn = document.getElementById("nextBtn");
const prevBtn = document.getElementById("prevBtn");

let currentIndex = 0;

// Mixed file extensions
const imageFiles = [
  "1.jpg","2.jpg","3.jpg","4.jpg","5.jpg","6.jpg","7.jpg","8.jpg","9.jpg","10.jpg",
  "11.jpg","12.jpg","13.jpg","14.jpg","15.jpg","16.jpg","17.jpg","18.jpg","19.jpg","20.jpg",
  "21.jpg","22.jpg","23.jpg","24.jpg","25.jpg","26.jpg","27.png","28.png","29.jpg","30.jpg",
  "31.jpg","32.jpg","33.jpg","34.jpg","35.jpg","36.jpg"
];

// Create all images and append immediately
imageFiles.forEach((file, index) => {
  const img = document.createElement("img");
  img.alt = `Image ${index+1}`;
  img.dataset.index = index;
  img.src = file;  // start loading
  img.loading = "lazy";

  // Fade-in when loaded
  img.onload = () => img.classList.add("loaded");

  // Open lightbox on click
  img.onclick = () => openLightbox(index);

  collage.appendChild(img);
});

// Lightbox functions
function openLightbox(index) {
  currentIndex = index;
  showImage();
  lightbox.classList.add("active");
}

function closeLightbox() { lightbox.classList.remove("active"); }

function showImage() { lightboxImage.src = imageFiles[currentIndex]; }

function nextImage() {
  currentIndex = (currentIndex + 1) % imageFiles.length;
  showImage();
}

function prevImage() {
  currentIndex = (currentIndex - 1 + imageFiles.length) % imageFiles.length;
  showImage();
}

// Buttons
closeBtn.onclick = closeLightbox;
nextBtn.onclick = nextImage;
prevBtn.onclick = prevImage;

// Keyboard
document.addEventListener("keydown", (e) => {
  if (!lightbox.classList.contains("active")) return;
  if (e.key === "ArrowRight") nextImage();
  if (e.key === "ArrowLeft") prevImage();
  if (e.key === "Escape") closeLightbox();
});

// Close lightbox on background click
lightbox.addEventListener("click", e => {
  if (e.target === lightbox) closeLightbox();
});
</script>

</body>
</html>
